language: c
dist: trusty
sudo: true

script:
  - sudo apt-get -y install expect csh xzdec lintian fakeroot checkinstall
  - ./configure && make && sudo checkinstall --install=no -y --pkgversion=0 --pkgname=firejail-amd64.deb
  - ( ./configure --prefix=/usr && make && sudo make install && make test-travis )
  - ( sudo make install-strip DESTDIR=$(readlink -f appdir) )
  - #If successful, build release tarball
  - #( cd appdir/ ; tar cfvj ../firejail-build$TRAVIS_BUILD_NUMBER.tar.bz2 . )
  - #curl --upload-file ./firejail-*.tar.bz2 https://transfer.sh/firejail-build$TRAVIS_BUILD_NUMBER.tar.bz2
  - # Could use https://github.com/probonopd/uploadtool to upload to GitHub Releases instead
  - # ls -lh out/* Assuming you have some files in out/ that you would like to upload
  - wget -c https://github.com/probonopd/uploadtool/raw/master/upload.sh
  - bash upload.sh *.deb

branches:
  except:
    - # Do not build tags that we create when we upload to GitHub Releases
    - /^(?i:continuous)$/
